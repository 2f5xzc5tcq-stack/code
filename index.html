<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Trắc nghiệm – Luyện tập</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PLFZVC1FT4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-PLFZVC1FT4', {'send_page_view': true,'cookie_flags': 'SameSite=None;Secure'});
  </script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    :root { --app-vh: 100vh; --bg-primary: #f8fafc; --bg-secondary: #ffffff; --text-primary: #0f172a; --text-secondary: #475569; --border-color: #e2e8f0; --accent-color: #3b82f6; }
    @supports (height: 100dvh) { :root { --app-vh: 100dvh; } }
    [data-theme="dark"] { --bg-primary: #0f172a; --bg-secondary: #1e293b; --text-primary: #f1f5f9; --text-secondary: #cbd5e1; --border-color: #334155; --accent-color: #60a5fa; }
    html, body { margin: 0; padding: 0; min-height: var(--app-vh); width: 100%; background: #0b1a2e; font-family: 'Inter', sans-serif; }
    .wrapper { width: 100%; display: flex; justify-content: center; padding: 20px; }
    body { overflow-x: hidden; }
    .choice { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; }
    .choice::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); transition: left 0.5s; }
    .choice:hover::before { left: 100%; }
    .choice:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    .choice:active { transform: translateY(0); box-shadow: 0 2px 4px rgba(0,0,0,0.06); }
    .fade-in { animation: fadeSlide 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    @keyframes fadeSlide { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    .badge { animation: pulse 0.3s cubic-bezier(0.4, 0, 0.2, 1); transform-origin: center; }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    .progress-bar { transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
    .question-nav-item { transition: all 0.2s ease; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; border-radius: 8px; background: #f1f5f9; color: #475569; border: 2px solid transparent; }
    .question-nav-item:hover { transform: scale(1.05); box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
    .question-nav-item.viewed { background: #fef3c7; color: #92400e; }
    .question-nav-item.correct { background: #d1fae5; color: #065f46; }
    .question-nav-item.wrong { background: #fecdd3; color: #991b1b; }
    .question-nav-item.active { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.3); }
    .sidebar { max-height: calc(100vh - 150px); overflow-y: auto; scrollbar-width: thin; scrollbar-color: var(--border-color) var(--bg-secondary); }
    .sidebar::-webkit-scrollbar { width: 6px; }
    .sidebar::-webkit-scrollbar-track { background: var(--bg-secondary); border-radius: 10px; }
    .sidebar::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 10px; }
    .sidebar::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }
    .subject-nav-item { transition: all 0.2s ease; cursor: pointer; }
    .subject-nav-item:hover { background: var(--bg-primary); }
    .subject-nav-item.active { background: linear-gradient(to right, #3b82f6, #8b5cf6); color: white; }
    .subject-nav-item.active svg { color: white; }
    [data-theme="dark"] body { background: #0f172a; }
    [data-theme="dark"] .bg-white, [data-theme="dark"] aside, [data-theme="dark"] .modal-content { background: var(--bg-secondary) !important; color: var(--text-primary) !important; }
    [data-theme="dark"] #card { background: #0f172a !important; border-color: #1e293b !important; }
    [data-theme="dark"] .text-slate-800, [data-theme="dark"] .text-slate-900, [data-theme="dark"] .text-slate-700 { color: var(--text-primary) !important; }
    [data-theme="dark"] .text-slate-600, [data-theme="dark"] .text-slate-500 { color: var(--text-secondary) !important; }
    [data-theme="dark"] .border-slate-200, [data-theme="dark"] .border-slate-100 { border-color: var(--border-color) !important; }
    [data-theme="dark"] .bg-slate-100, [data-theme="dark"] .bg-slate-50, [data-theme="dark"] .bg-slate-200 { background: #1e293b !important; }
    [data-theme="dark"] .from-emerald-100, [data-theme="dark"] .from-emerald-50 { --tw-gradient-from: #065f46 !important; }
    [data-theme="dark"] .to-green-100, [data-theme="dark"] .to-green-50 { --tw-gradient-to: #047857 !important; }
    [data-theme="dark"] .from-rose-100, [data-theme="dark"] .from-rose-50 { --tw-gradient-from: #881337 !important; }
    [data-theme="dark"] .to-red-100, [data-theme="dark"] .to-red-50 { --tw-gradient-to: #991b1b !important; }
    [data-theme="dark"] .choice .text-slate-900, [data-theme="dark"] .choice .text-slate-800 { color: #f1f5f9 !important; }
    [data-theme="dark"] .bg-gradient-to-br { background: #1e293b !important; }
    [data-theme="dark"] .hover\:bg-slate-100:hover, [data-theme="dark"] .hover\:bg-slate-50:hover { background: #334155 !important; }
    [data-theme="dark"] #summary { background: linear-gradient(to bottom right, #1e293b, #1e3a52, #1e293b) !important; }
    [data-theme="dark"] #summary #summaryText { background: #0f172a !important; color: #e2e8f0 !important; border-color: #334155 !important; }
    [data-theme="dark"] #statsChart { background: #0f172a !important; border-color: #334155 !important; }
    [data-theme="dark"] #statsChart h3, [data-theme="dark"] #chartPercentage, [data-theme="dark"] #statsChart span { color: #e2e8f0 !important; }
    [data-theme="dark"] #statsChart .text-xs { color: #94a3b8 !important; }
    .disclaimer-modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; width: 100vw; height: 100vh; background: linear-gradient(135deg, rgba(30,41,59,0.95), rgba(15,23,42,0.98)); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); z-index: 9999; animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); display: flex; align-items: center; justify-content: center; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; }
    .disclaimer-modal::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 20% 30%, rgba(59,130,246,0.1) 0%, transparent 50%), radial-gradient(circle at 80% 70%, rgba(139,92,246,0.1) 0%, transparent 50%), radial-gradient(circle at 50% 50%, rgba(16,185,129,0.05) 0%, transparent 50%); pointer-events: none; }
    .disclaimer-content { background: linear-gradient(145deg, #ffffff, #f8fafc); border-radius: 28px; padding: 48px 56px; max-width: 540px; width: 90%; margin: auto; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25), 0 0 0 1px rgba(0,0,0,0.05); animation: slideUp 0.5s cubic-bezier(0.16,1,0.3,1); position: relative; text-align: center; }
    [data-theme="dark"] .disclaimer-content { background: linear-gradient(145deg, #1e293b, #0f172a); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.1); }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(40px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
    @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    .disclaimer-icon { width: 88px; height: 88px; margin: 0 auto 28px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #ea580c 100%); border-radius: 50%; color: white; box-shadow: 0 12px 30px -6px rgba(251,191,36,0.45), 0 0 0 5px rgba(251,191,36,0.12); animation: pulse 2s ease-in-out infinite; }
    .disclaimer-icon svg { width: 48px; height: 48px; }
    .disclaimer-title { font-size: 32px; font-weight: 700; text-align: center; margin-bottom: 18px; color: #0f172a; background: linear-gradient(135deg, #0f172a, #334155); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: -0.02em; }
    [data-theme="dark"] .disclaimer-title { background: linear-gradient(135deg, #f1f5f9, #cbd5e1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .disclaimer-text { font-size: 15.5px; line-height: 1.7; color: #64748b; text-align: center; margin-bottom: 32px; max-width: 480px; margin-left: auto; margin-right: auto; }
    .disclaimer-text strong { color: #334155; font-weight: 600; }
    [data-theme="dark"] .disclaimer-text { color: #94a3b8; }
    [data-theme="dark"] .disclaimer-text strong { color: #e2e8f0; }
    .disclaimer-button { width: 100%; padding: 18px 32px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%); color: white; border: none; border-radius: 16px; font-size: 17px; font-weight: 600; cursor: pointer; transition: all 0.3s cubic-bezier(0.16,1,0.3,1); box-shadow: 0 12px 28px -6px rgba(59,130,246,0.45), 0 0 0 1px rgba(59,130,246,0.15); display: flex; align-items: center; justify-content: center; gap: 8px; letter-spacing: 0.01em; }
    .disclaimer-button:hover { transform: translateY(-2px); box-shadow: 0 18px 40px -6px rgba(59,130,246,0.55), 0 0 0 1px rgba(59,130,246,0.25); background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 50%, #1e40af 100%); }
    .disclaimer-button:active { transform: translateY(0); }
    .disclaimer-button-icon { width: 5px; height: 20px; }
    .subject-card { position: relative; padding: 32px; border-radius: 24px; border: 2px solid transparent; background: linear-gradient(145deg, rgba(255,255,255,0.98), rgba(248,250,252,0.95)); backdrop-filter: blur(20px); cursor: pointer; transition: all 0.5s cubic-bezier(0.34,1.56,0.64,1); overflow: hidden; box-shadow: 0 10px 40px -10px rgba(0,0,0,0.15), 0 4px 12px -4px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.8); }
    .subject-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 6px; background: linear-gradient(90deg, var(--subject-color-start), var(--subject-color-end)); transform: scaleX(0); transform-origin: left; transition: transform 0.6s cubic-bezier(0.34,1.56,0.64,1); box-shadow: 0 4px 16px -2px var(--subject-color-start); }
    .subject-card::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, var(--subject-color-start) 0%, transparent 80%); opacity: 0; transition: opacity 0.5s ease; pointer-events: none; }
    .subject-card:hover::before { transform: scaleX(1); }
    .subject-card:hover::after { opacity: 0.08; }
    .subject-card:hover { transform: translateY(-12px) scale(1.03); border-color: var(--subject-color-start); box-shadow: 0 30px 60px -15px rgba(0,0,0,0.25), 0 20px 40px -10px var(--subject-color-start), 0 0 0 2px var(--subject-color-start), inset 0 1px 0 rgba(255,255,255,1); }
    .subject-card:active { transform: translateY(-6px) scale(1.01); }
    .subject-card-icon { width: 72px; height: 72px; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; background: linear-gradient(135deg, var(--subject-color-start), var(--subject-color-end)); color: white; box-shadow: 0 12px 24px -6px var(--subject-color-start), 0 0 0 4px rgba(255,255,255,0.5), inset 0 -2px 8px rgba(0,0,0,0.2); transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1); animation: float 3s ease-in-out infinite; }
    @keyframes float { 0%,100% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-8px) rotate(2deg); } }
    .subject-card:hover .subject-card-icon { transform: scale(1.15) rotate(-8deg); box-shadow: 0 20px 40px -8px var(--subject-color-start), 0 0 0 6px rgba(255,255,255,0.8), inset 0 -2px 12px rgba(0,0,0,0.3); animation: none; }
    .subject-card-title { font-size: 22px; font-weight: 800; color: #0f172a; margin-bottom: 12px; letter-spacing: -0.02em; line-height: 1.3; }
    .subject-card-desc { font-size: 14px; color: #64748b; line-height: 1.6; margin-bottom: 20px; font-weight: 500; }
    .subject-card-button { width: 100%; padding: 16px 24px; background: linear-gradient(135deg, var(--subject-color-start), var(--subject-color-end)); color: white; border: none; border-radius: 16px; font-size: 16px; font-weight: 700; cursor: pointer; transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1); box-shadow: 0 8px 20px -4px var(--subject-color-start), 0 4px 12px -2px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.3); position: relative; overflow: hidden; letter-spacing: 0.02em; }
    .subject-card-button::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; border-radius: 50%; background: rgba(255,255,255,0.4); transform: translate(-50%,-50%); transition: width 0.8s cubic-bezier(0.34,1.56,0.64,1), height 0.8s cubic-bezier(0.34,1.56,0.64,1); }
    .subject-card-button:hover::before { width: 300px; height: 300px; }
    .subject-card-button:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 16px 32px -4px var(--subject-color-start), 0 8px 20px -2px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.5); }
    .subject-card-button:active { transform: translateY(0) scale(0.98); }
    .subject-card-locked { opacity: 0.7; filter: grayscale(0.3); cursor: not-allowed; }
    .subject-card-locked:hover { transform: none; border-color: transparent; box-shadow: 0 10px 40px -10px rgba(0,0,0,0.15), 0 4px 12px -4px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.8); }
    .subject-card-locked::before { display: none; }
    .subject-card-locked .subject-card-icon { animation: none; opacity: 0.6; }
    .subject-card-locked:hover .subject-card-icon { transform: none; box-shadow: 0 12px 24px -6px var(--subject-color-start), 0 0 0 4px rgba(255,255,255,0.5), inset 0 -2px 8px rgba(0,0,0,0.2); }
    .subject-card-locked .subject-card-button { background: linear-gradient(135deg, #94a3b8, #64748b); cursor: not-allowed; opacity: 0.6; }
    .subject-card-locked .subject-card-button:hover { transform: none; box-shadow: 0 8px 20px -4px rgba(100,116,139,0.3), 0 4px 12px -2px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.3); }
    .subject-card-locked .subject-card-button::before { display: none; }
    .subject-card-button span { position: relative; z-index: 1; }
    [data-theme="dark"] .subject-card { background: linear-gradient(145deg, rgba(30,41,59,0.95), rgba(15,23,42,0.9)); border-color: #334155; box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
    [data-theme="dark"] .subject-card:hover { box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5), 0 0 0 1px var(--subject-color-start); }
    [data-theme="dark"] .subject-card-title { color: #f1f5f9; }
    [data-theme="dark"] .subject-card-desc { color: #94a3b8; }
    [data-theme="dark"] .subject-card .border-slate-200 { border-color: rgba(255,255,255,0.1) !important; }
    [data-theme="dark"] .subject-card .bg-slate-200 { background: rgba(255,255,255,0.1) !important; }
    [data-theme="dark"] .subject-card .text-slate-600, [data-theme="dark"] .subject-card .text-slate-500 { color: #94a3b8 !important; }
    [data-theme="dark"] .modal-content { background: linear-gradient(145deg, rgba(30,41,59,0.98), rgba(15,23,42,0.95)); box-shadow: 0 25px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.1); }
    [data-theme="dark"] .modal-content::before { background: linear-gradient(180deg, rgba(245,158,11,0.08) 0%, transparent 100%); }
    [data-theme="dark"] .modal-content h3 { color: #f1f5f9 !important; }
    [data-theme="dark"] .modal-content p { color: #94a3b8 !important; }
    [data-theme="dark"] #cancelChangeSubject { background: rgba(30,41,59,0.8); border-color: #475569; color: #e2e8f0; }
    [data-theme="dark"] #cancelChangeSubject:hover { background: rgba(51,65,85,0.9); border-color: #64748b; }
    @keyframes float { 0%,100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    .subject-card { animation: fadeInUp 0.6s ease-out backwards; }
    .subject-card:nth-child(1) { animation-delay: 0.1s; }
    .subject-card:nth-child(2) { animation-delay: 0.2s; }
    .subject-card:nth-child(3) { animation-delay: 0.3s; }
    .subject-card-icon { animation: float 3s ease-in-out infinite; }
    .subject-card:nth-child(1) .subject-card-icon { animation-delay: 0s; }
    .subject-card:nth-child(2) .subject-card-icon { animation-delay: 0.5s; }
    .subject-card:nth-child(3) .subject-card-icon { animation-delay: 1s; }
    #subjectSelection h2 { animation: fadeInUp 0.5s ease-out; }
    #subjectSelection p { animation: fadeInUp 0.6s ease-out 0.1s backwards; }
    .mobile-menu { position: fixed; top: 0; left: -100%; width: 280px; height: 100vh; background: var(--bg-secondary); box-shadow: 2px 0 10px rgba(0,0,0,0.1); transition: left 0.3s ease; z-index: 1000; }
    .mobile-menu.open { left: 0; }
    .mobile-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); opacity: 0; pointer-events: none; transition: opacity 0.3s ease; z-index: 999; }
    .mobile-overlay.open { opacity: 1; pointer-events: all; }
    #onlineCounter { transition: all 0.3s ease; }
    [data-theme="dark"] #onlineCounter { background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(34,197,94,0.15)); border-color: rgba(16,185,129,0.3); }
    [data-theme="dark"] #onlineCounter svg { color: #10b981; }
    [data-theme="dark"] #onlineCount { color: #10b981; }
    [data-theme="dark"] #onlineCounter span.text-emerald-600 { color: #6ee7b7; }
    .dark-mode-toggle { position: relative; width: 60px; height: 30px; background: #cbd5e1; border-radius: 15px; cursor: pointer; transition: background 0.3s ease; }
    .dark-mode-toggle.active { background: #3b82f6; }
    .dark-mode-toggle::before { content: ''; position: absolute; top: 3px; left: 3px; width: 24px; height: 24px; background: white; border-radius: 50%; transition: left 0.3s ease; }
    .dark-mode-toggle.active::before { left: 33px; }
    .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; width: 100vw; height: 100vh; background: linear-gradient(135deg, rgba(30,41,59,0.9), rgba(15,23,42,0.95)); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); z-index: 2000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; display: flex; align-items: center; justify-content: center; padding: 20px 0; }
    .modal::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 30% 40%, rgba(245,158,11,0.1) 0%, transparent 50%), radial-gradient(circle at 70% 60%, rgba(239,68,68,0.08) 0%, transparent 50%); pointer-events: none; }
    .modal.open { opacity: 1; pointer-events: all; }
    .modal-content { background: linear-gradient(145deg, rgba(255,255,255,0.98), rgba(248,250,252,0.95)); backdrop-filter: blur(20px); border-radius: 24px; padding: 32px; max-width: 90%; width: 90%; margin: 0 auto; box-shadow: 0 25px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.1), inset 0 1px 0 rgba(255,255,255,0.5); transform: scale(0.9); transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1); position: relative; }
    .modal-content::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 200px; background: linear-gradient(180deg, rgba(245,158,11,0.05) 0%, transparent 100%); border-radius: 24px 24px 0 0; pointer-events: none; }
    .modal.open .modal-content { transform: scale(1); }
    .bookmark-btn { cursor: pointer; transition: transform 0.2s ease; }
    .bookmark-btn:hover { transform: scale(1.1); }
    .bookmark-btn.active { color: #f59e0b; }
    @media (max-width: 768px) {
      .disclaimer-modal { padding: 0; }
      .disclaimer-content { margin: auto !important; padding: 28px 22px !important; width: 88% !important; max-width: 380px !important; }
      .disclaimer-icon { width: 64px !important; height: 64px !important; margin-bottom: 18px !important; }
      .disclaimer-icon svg { width: 36px !important; height: 36px !important; }
      .disclaimer-title { font-size: 22px !important; margin-bottom: 12px !important; }
      .disclaimer-text { font-size: 13px !important; line-height: 1.6 !important; margin-bottom: 20px !important; }
      .disclaimer-button { padding: 13px 18px !important; font-size: 14px !important; }
      .modal-content { margin: 30px auto !important; padding: 28px 20px !important; width: 92% !important; }
      #subjectSelection { padding: 32px 20px !important; max-width: 100% !important; margin: 30px auto !important; }
      #subjectSelection h2 { font-size: 32px !important; margin-bottom: 16px !important; line-height: 1.2 !important; }
      #subjectSelection p { font-size: 15px !important; margin-bottom: 32px !important; line-height: 1.5 !important; opacity: 0.9; }
      #subjectCards { gap: 24px !important; }
      .subject-card { padding: 28px 24px !important; border-radius: 20px !important; box-shadow: 0 8px 32px -8px rgba(0,0,0,0.15), 0 4px 16px -4px rgba(0,0,0,0.1) !important; }
      .subject-card-icon { width: 64px !important; height: 64px !important; border-radius: 18px !important; margin-bottom: 18px !important; box-shadow: 0 8px 20px -4px var(--subject-color-start), 0 0 0 3px rgba(255,255,255,0.4) !important; }
      .subject-card-icon svg { width: 32px !important; height: 32px !important; }
      .subject-card-title { font-size: 22px !important; margin-bottom: 12px !important; line-height: 1.3 !important; }
      .subject-card-desc { font-size: 14px !important; margin-bottom: 20px !important; line-height: 1.6 !important; opacity: 0.85; }
      .subject-card-button { padding: 16px 24px !important; font-size: 16px !important; border-radius: 16px !important; font-weight: 700 !important; box-shadow: 0 6px 16px -2px var(--subject-color-start), 0 4px 12px -2px rgba(0,0,0,0.15) !important; }
      .subject-card:hover { transform: translateY(-6px) scale(1.02) !important; }
      .subject-card:active { transform: translateY(-2px) scale(0.99) !important; }
      .subject-card .h-1\.5 { height: 6px !important; }
      .subject-card .absolute.top-4.right-4 { top: 12px !important; right: 12px !important; }
      .subject-card .absolute.top-4.right-4 > div { padding: 8px 12px !important; font-size: 11px !important; }
      .subject-card .absolute.top-4.right-4 svg { width: 14px !important; height: 14px !important; }
      .modal-content { max-width: 92% !important; padding: 28px 20px !important; border-radius: 24px !important; margin: 20px auto !important; }
      .disclaimer-content { padding: 32px 24px !important; margin: 20px auto !important; }
      .disclaimer-icon { width: 72px !important; height: 72px !important; margin-bottom: 20px !important; }
      .disclaimer-icon svg { width: 40px !important; height: 40px !important; }
      .disclaimer-title { font-size: 24px !important; margin-bottom: 14px !important; }
      .disclaimer-text { font-size: 14px !important; line-height: 1.6 !important; margin-bottom: 24px !important; }
      .disclaimer-button { padding: 14px 20px !important; font-size: 15px !important; }
    }
    @media (max-width: 480px) {
      .disclaimer-modal { padding: 0; }
      .disclaimer-content { margin: auto !important; padding: 24px 20px !important; width: 90% !important; max-width: 340px !important; }
      .disclaimer-icon { width: 60px !important; height: 60px !important; margin-bottom: 16px !important; }
      .disclaimer-icon svg { width: 32px !important; height: 32px !important; }
      .disclaimer-title { font-size: 20px !important; margin-bottom: 10px !important; }
      .disclaimer-text { font-size: 12.5px !important; line-height: 1.55 !important; margin-bottom: 18px !important; }
      .disclaimer-button { padding: 12px 16px !important; font-size: 14px !important; }
      #subjectSelection { padding: 24px 16px !important; }
      #subjectSelection h2 { font-size: 28px !important; margin-bottom: 12px !important; }
      #subjectSelection p { font-size: 14px !important; margin-bottom: 24px !important; }
      #subjectCards { grid-template-columns: 1fr !important; gap: 20px !important; }
      .subject-card { padding: 24px 20px !important; border-radius: 18px !important; }
      .subject-card-icon { width: 56px !important; height: 56px !important; border-radius: 16px !important; margin-bottom: 16px !important; }
      .subject-card-icon svg { width: 28px !important; height: 28px !important; }
      .subject-card-title { font-size: 20px !important; margin-bottom: 10px !important; }
      .subject-card-desc { font-size: 13px !important; margin-bottom: 18px !important; }
      .subject-card-button { padding: 14px 20px !important; font-size: 15px !important; border-radius: 14px !important; }
      .modal-content { max-width: 95% !important; padding: 24px 18px !important; border-radius: 20px !important; }
      .disclaimer-content { padding: 28px 20px !important; }
      .disclaimer-icon { width: 64px !important; height: 64px !important; margin-bottom: 18px !important; }
      .disclaimer-icon svg { width: 36px !important; height: 36px !important; }
      .disclaimer-title { font-size: 22px !important; }
      .disclaimer-text { font-size: 13px !important; margin-bottom: 20px !important; }
    }

  .disclaimer-modal{
    display:flex;
    align-items:flex-start;
    justify-content:center;
    position:fixed;
    inset:0;
    width:100vw;
    min-height:100dvh;
    background:linear-gradient(135deg, rgba(30,41,59,0.95), rgba(15,23,42,0.98));
    backdrop-filter:blur(12px);
    -webkit-backdrop-filter:blur(12px);
    z-index:9999;
    animation:fadeIn 0.4s cubic-bezier(0.16,1,0.3,1);
    overflow-y:auto;
    overflow-x:hidden;
    -webkit-overflow-scrolling:touch;
    padding:clamp(16px,4vw,40px);
  }

  .disclaimer-content{
    max-width:clamp(360px,92vw,1100px);
    width:100%;
    margin:0 auto;
    padding:clamp(24px,3vw,40px);
    border-radius:24px;
  }

  #subjectSelection{
    max-width:clamp(360px,92vw,900px);
    width:100%;
    padding:clamp(24px,3vw,48px);
  }

  #subjectCards{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(260px, 1fr));
    gap:clamp(16px,2.5vw,24px);
  }

  .subject-card{width:100%}

  /* Live Chat Styles */
  .chat-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 350px;
    max-height: 500px;
    background: linear-gradient(145deg, #ffffff, #f8fafc);
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    z-index: 1000;
    transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  }
  
  .chat-container.minimized {
    max-height: 60px;
  }
  
  [data-theme="dark"] .chat-container {
    background: linear-gradient(145deg, #1e293b, #0f172a);
    box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.1);
  }
  
  .chat-header {
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    color: white;
    padding: 16px;
    border-radius: 16px 16px 0 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    user-select: none;
  }
  
  .chat-header-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 15px;
  }
  
  .chat-header-actions {
    display: flex;
    gap: 8px;
  }
  
  .chat-header-btn {
    width: 28px;
    height: 28px;
    border-radius: 8px;
    background: rgba(255,255,255,0.2);
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
  }
  
  .chat-header-btn:hover {
    background: rgba(255,255,255,0.3);
    transform: scale(1.05);
  }
  
  .chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    max-height: 350px;
    scrollbar-width: thin;
    scrollbar-color: #cbd5e1 transparent;
  }
  
  .chat-messages::-webkit-scrollbar {
    width: 6px;
  }
  
  .chat-messages::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 10px;
  }
  
  .chat-message {
    padding: 10px 12px;
    border-radius: 12px;
    max-width: 80%;
    word-wrap: break-word;
    animation: slideIn 0.3s ease;
  }
  
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .chat-message.own {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
    align-self: flex-end;
    border-bottom-right-radius: 4px;
  }
  
  .chat-message.other {
    background: #f1f5f9;
    color: #0f172a;
    align-self: flex-start;
    border-bottom-left-radius: 4px;
  }
  
  [data-theme="dark"] .chat-message.other {
    background: #334155;
    color: #f1f5f9;
  }
  
  .chat-message-user {
    font-size: 11px;
    font-weight: 600;
    margin-bottom: 4px;
    opacity: 0.8;
  }
  
  .chat-message-text {
    font-size: 13px;
    line-height: 1.4;
  }
  
  .chat-message-time {
    font-size: 10px;
    opacity: 0.6;
    margin-top: 4px;
  }
  
  .chat-input-container {
    padding: 12px;
    border-top: 1px solid #e2e8f0;
    display: flex;
    gap: 8px;
  }
  
  [data-theme="dark"] .chat-input-container {
    border-top-color: #334155;
  }
  
  .chat-input {
    flex: 1;
    padding: 10px 12px;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    font-size: 16px; /* Minimum 16px to prevent iOS zoom */
    outline: none;
    transition: all 0.2s;
    background: white;
    color: #0f172a;
  }
  
  .chat-input:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
  }
  
  [data-theme="dark"] .chat-input {
    background: #334155;
    color: #f1f5f9;
    border-color: #475569;
  }
  
  [data-theme="dark"] .chat-input:focus {
    border-color: #60a5fa;
    box-shadow: 0 0 0 3px rgba(96,165,250,0.1);
  }
  
  .chat-send-btn {
    padding: 10px 16px;
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
  }
  
  .chat-send-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59,130,246,0.4);
  }
  
  .chat-send-btn:active {
    transform: translateY(0);
  }
  
  .chat-send-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  @media (max-width: 768px) {
    .chat-container {
      width: calc(100vw - 40px);
      max-width: 350px;
      bottom: 10px;
      right: 10px;
    }
    
    /* Hide floating chat button on mobile, use header button instead */
    #chatToggleBtn {
      display: none !important;
    }
    
    #chatToggleBtn svg {
      width: 20px !important;
      height: 20px !important;
    }
  }

  /* Leaderboard Styles */
  .leaderboard-tab {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 20px;
    border-radius: 12px;
    border: 2px solid #e2e8f0;
    background: white;
    color: #64748b;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .leaderboard-tab:hover {
    border-color: #cbd5e1;
    background: #f8fafc;
  }

  .leaderboard-tab.active {
    border-color: #f59e0b;
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    color: white;
    box-shadow: 0 4px 12px rgba(251, 191, 36, 0.4);
  }

  .leaderboard-item {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px 20px;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    transition: all 0.3s;
    animation: slideIn 0.4s ease-out both;
  }

  .leaderboard-item:hover {
    transform: translateX(4px);
    border-color: #cbd5e1;
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
  }

  .leaderboard-rank {
    min-width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
    border-radius: 12px;
    font-weight: 700;
    font-size: 16px;
    color: #475569;
  }

  .leaderboard-rank.gold {
    background: linear-gradient(135deg, #fef3c7, #fde047);
    color: #92400e;
    box-shadow: 0 4px 12px rgba(250, 204, 21, 0.3);
  }

  .leaderboard-rank.silver {
    background: linear-gradient(135deg, #f1f5f9, #cbd5e1);
    color: #475569;
    box-shadow: 0 4px 12px rgba(203, 213, 225, 0.3);
  }

  .leaderboard-rank.bronze {
    background: linear-gradient(135deg, #fed7aa, #fb923c);
    color: #7c2d12;
    box-shadow: 0 4px 12px rgba(251, 146, 60, 0.3);
  }

  .leaderboard-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3b82f6, #8b5cf6);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    font-size: 18px;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  }

  .leaderboard-info {
    flex: 1;
    min-width: 0;
  }

  .leaderboard-name {
    font-weight: 700;
    font-size: 16px;
    color: #1e293b;
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
  }

  .leaderboard-stats {
    font-size: 13px;
    color: #64748b;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .leaderboard-score {
    font-size: 20px;
    font-weight: 700;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .verified-badge {
    display: inline-flex;
    padding: 2px 8px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 600;
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  #leaderboardModal .lb-header::before,
  #leaderboardModal .lb-topbar,
  #leaderboardModal .lb-header,
  #leaderboardModal .modal-content::before,
  #leaderboardModal .bg-slate-800,
  #leaderboardModal .bg-slate-900 {
    background: transparent !important;
    box-shadow: none !important;
    border: 0 !important;
  }



  </style>
</head>
<body class="text-slate-900">
  <div id="disclaimerModal" class="disclaimer-modal">
    <div id="disclaimerInfo" class="disclaimer-content">
      <div class="disclaimer-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"/></svg>
      </div>
      <h2 class="disclaimer-title">Chú ý</h2>
      <p class="disclaimer-text">Tất cả câu hỏi trắc nghiệm được AI tổng hợp qua sách giáo khoa và các nguồn uy tín.<br><strong>Lưu ý:</strong> Nếu phát hiện câu nào chưa chính xác, vui lòng tham khảo thêm tài liệu gốc.</p>
      <button id="disclaimerButton" class="disclaimer-button"><span>Đã hiểu</span></button>
    </div>
    <div id="subjectSelection" class="disclaimer-content subject-container" style="display: none">
      <h2 class="disclaimer-title" style="margin-bottom: 12px;">Chọn môn học</h2>
      <p class="text-sm text-slate-500 mb-8 text-center">Chọn môn học bạn muốn luyện tập</p>
      <div id="subjectCards" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
    </div>
  </div>

  <div id="changeSubjectModal" class="modal">
    <div class="modal-content" style="max-width: 480px; width: 90%; position: relative; z-index: 1; padding: 48px 40px;">
      <div class="text-center mb-8">
        <div class="mx-auto w-24 h-24 rounded-full flex items-center justify-center mb-6 relative" style="background: linear-gradient(135deg, #fbbf24, #f59e0b); box-shadow: 0 15px 40px rgba(251, 191, 36, 0.5), 0 0 0 6px rgba(251, 191, 36, 0.1); animation: pulse 2s ease-in-out infinite;">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-12 h-12 text-white"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"/></svg>
        </div>
        <h3 class="text-3xl font-bold mb-4 text-slate-900">Đổi môn học?</h3>
        <p class="text-slate-600 text-base leading-relaxed px-4">Bạn có chắc muốn đổi môn học?<br>Tiến độ hiện tại sẽ được lưu lại.</p>
      </div>
      <div class="flex gap-4">
        <button id="cancelChangeSubject" class="flex-1 px-8 py-4 rounded-2xl border-2 border-slate-300 bg-white text-slate-700 font-bold text-lg hover:bg-slate-50 hover:border-slate-400 transition-all duration-200 hover:scale-105 active:scale-100">Hủy bỏ</button>
        <button id="confirmChangeSubject" class="flex-1 px-8 py-4 rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold text-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105 active:scale-100">Xác nhận</button>
      </div>
    </div>
  </div>

  <div id="resumeQuizModal" class="modal">
    <div class="modal-content" style="max-width: 520px; width: 90%; position: relative; z-index: 1; padding: 48px 40px;">
      <div class="text-center mb-8">
        <div class="mx-auto w-24 h-24 rounded-full flex items-center justify-center mb-6 relative" style="background: linear-gradient(135deg, #3b82f6, #2563eb); box-shadow: 0 15px 40px rgba(59, 130, 246, 0.5), 0 0 0 6px rgba(59, 130, 246, 0.1);">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-12 h-12 text-white"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/></svg>
        </div>
        <h3 class="text-3xl font-bold mb-2 text-slate-900">Tiếp tục làm bài?</h3>
        <p class="text-lg font-semibold text-blue-600 mb-6" id="resumeSubjectName">Sinh học</p>
      </div>
      <div class="bg-gradient-to-br from-slate-50 to-blue-50 rounded-2xl p-6 mb-6 border border-slate-200">
        <div class="grid grid-cols-2 gap-4">
          <div class="text-center">
            <div class="text-3xl font-bold text-blue-600 mb-1" id="resumeProgress">45%</div>
            <div class="text-xs text-slate-600 font-medium">Tiến độ</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-emerald-600 mb-1" id="resumeCorrect">12</div>
            <div class="text-xs text-slate-600 font-medium">Câu đã trả lời</div>
          </div>
        </div>
        <div class="mt-4 pt-4 border-t border-slate-200 flex items-center justify-between text-sm">
          <div class="flex items-center gap-2 text-slate-600">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/></svg>
            <span id="resumeTime">30 phút trước</span>
          </div>
          <div class="font-semibold text-slate-700" id="resumeQuestion">Câu 15/88</div>
        </div>
      </div>
      <div class="flex flex-col gap-3">
        <button id="continueQuizBtn" class="w-full px-8 py-4 rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold text-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105 active:scale-100">Tiếp tục làm bài</button>
        <button id="restartQuizBtn" class="w-full px-8 py-4 rounded-2xl border-2 border-slate-300 bg-white text-slate-700 font-bold text-lg hover:bg-slate-50 hover:border-slate-400 transition-all duration-200 hover:scale-105 active:scale-100">Làm lại từ đầu</button>
      </div>
    </div>
  </div>

  <!-- Submit Warning Modal -->
  <div id="submitWarningModal" class="modal">
    <div class="modal-content" style="max-width: 480px; width: 90%; position: relative; z-index: 1; padding: 48px 40px;">
      <div class="text-center mb-8">
        <div class="mx-auto w-24 h-24 rounded-full flex items-center justify-center mb-6 relative" style="background: linear-gradient(135deg, #f59e0b, #dc2626); box-shadow: 0 15px 40px rgba(245, 158, 11, 0.5), 0 0 0 6px rgba(245, 158, 11, 0.1); animation: pulse 2s ease-in-out infinite;">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-12 h-12 text-white">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
          </svg>
        </div>
        <h3 class="text-3xl font-bold mb-4 text-slate-900">Cảnh báo</h3>
        <p class="text-slate-600 text-base leading-relaxed px-4">
          Bạn còn <span id="unansweredCount" class="font-bold text-orange-600">0</span> câu chưa trả lời.<br>
          Bạn có chắc muốn nộp bài?
        </p>
      </div>
      <div class="flex gap-4">
        <button id="cancelSubmit" class="flex-1 px-8 py-4 rounded-2xl border-2 border-slate-300 bg-white text-slate-700 font-bold text-lg hover:bg-slate-50 hover:border-slate-400 transition-all duration-200 hover:scale-105 active:scale-100">Hủy bỏ</button>
        <button id="confirmSubmit" class="flex-1 px-8 py-4 rounded-2xl bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold text-lg hover:from-orange-600 hover:to-red-700 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105 active:scale-100">Vẫn nộp</button>
      </div>
    </div>
  </div>

  <div class="mx-auto max-w-7xl px-4 py-6" id="quizContainer" style="display: none;">
    <header class="mb-6 text-center">
      <div class="inline-block mb-2 px-4 py-1.5 bg-gradient-to-r from-blue-500 to-purple-500 text-white text-xs font-semibold rounded-full shadow-sm">Luyện tập trắc nghiệm</div>
      <h1 id="subjectTitle" class="text-2xl sm:text-3xl font-bold bg-gradient-to-r from-slate-900 via-blue-900 to-purple-900 bg-clip-text text-transparent mb-2">Trắc nghiệm Lịch sử</h1>
      <p id="subjectDesc" class="text-xs sm:text-sm text-slate-600 max-w-2xl mx-auto leading-relaxed">Lịch sử Liên hợp quốc & ASEAN - Chọn đáp án để xem kết quả và lời giải thích chi tiết.</p>
    </header>

    <section class="mb-6 flex flex-wrap items-center justify-between gap-3">
      <div class="flex flex-wrap items-center gap-3">
        <button id="btnChangeSubject" class="group relative overflow-hidden rounded-xl bg-gradient-to-r from-indigo-500 to-purple-500 px-5 py-2.5 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105"><span class="relative z-10">Đổi môn</span></button>
        <button id="btnRestart" class="group relative overflow-hidden rounded-xl bg-gradient-to-r from-slate-700 to-slate-900 px-5 py-2.5 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105"><span class="relative z-10">Làm lại</span></button>
        <button id="btnBookmarks" class="group relative overflow-hidden rounded-xl bg-gradient-to-r from-amber-500 to-orange-500 px-5 py-2.5 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105"><span class="relative z-10">Câu đã đánh dấu</span></button>
        <button id="btnHistory" class="group relative overflow-hidden rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 px-5 py-2.5 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105"><span class="relative z-10">Lịch sử</span></button>
        <button id="btnLeaderboard" class="group relative overflow-hidden rounded-xl bg-gradient-to-r from-yellow-500 to-orange-500 px-5 py-2.5 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105">

            Bảng xếp hạng
          </span>
        </button>
        <button id="btnOpenChatMobile" class="md:hidden group relative overflow-hidden rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 px-5 py-2.5 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 hover:scale-105"><span class="relative z-10">Mở Chat</span></button>
      </div>
      <div class="flex items-center gap-4">
        <div id="onlineCounter" class="flex items-center gap-2 px-3 py-1.5 bg-gradient-to-r from-emerald-50 to-green-50 rounded-full border border-emerald-200">
          <div class="relative"><div class="w-2 h-2 bg-emerald-500 rounded-full animate-ping absolute"></div><div class="w-2 h-2 bg-emerald-500 rounded-full"></div></div>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-emerald-600"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"/></svg>
          <span id="onlineCount" class="text-sm font-semibold text-emerald-700">--</span>
          <span class="text-xs text-emerald-600 hidden sm:inline">online</span>
        </div>
        <span class="text-sm text-slate-600 hidden sm:block">Dark mode</span>
        <div id="darkModeToggle" class="dark-mode-toggle"></div>
      </div>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <aside class="lg:col-span-3">
        <div class="bg-white rounded-2xl p-4 shadow-lg border border-slate-100 sticky top-6">
          <h2 class="font-bold text-slate-800 mb-3 text-sm">Danh sách câu hỏi</h2>
          <div id="questionNav" class="sidebar grid grid-cols-5 sm:grid-cols-6 lg:grid-cols-4 gap-2"></div>
          <div class="mt-4 pt-4 border-t border-slate-200">
            <div class="flex flex-col gap-2 text-xs">
              <div class="flex items-center gap-1.5"><div class="w-3 h-3 rounded bg-slate-200"></div><span class="text-slate-600">Chưa xem</span></div>
              <div class="flex items-center gap-1.5"><div class="w-3 h-3 rounded bg-amber-200"></div><span class="text-slate-600">Đã xem</span></div>
              <div class="flex items-center gap-1.5"><div class="w-3 h-3 rounded bg-emerald-200"></div><span class="text-slate-600">Câu đúng</span></div>
              <div class="flex items-center gap-1.5"><div class="w-3 h-3 rounded bg-rose-200"></div><span class="text-slate-600">Câu sai</span></div>
            </div>
          </div>
        </div>
      </aside>

      <main class="lg:col-span-9">
        <section class="mb-6 bg-white rounded-2xl p-5 shadow-md border border-slate-100">
          <div class="flex items-center justify-between text-sm mb-3 flex-wrap gap-3">
            <div id="progressText" class="font-semibold text-slate-800 text-base">Câu 1 / 100</div>
            <div class="flex items-center gap-3 flex-wrap">
              <span id="timeText" class="badge inline-flex items-center gap-1 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-3 py-1.5 font-semibold text-xs shadow-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/></svg><span id="timeValue">00:00</span></span>
              <span id="wrongBadge" class="badge inline-flex items-center gap-1 rounded-lg bg-gradient-to-r from-rose-500 to-red-500 text-white px-3 py-1.5 font-semibold text-xs shadow-sm">Sai: 0</span>
              <span id="rightBadge" class="badge inline-flex items-center gap-1 rounded-lg bg-gradient-to-r from-emerald-500 to-green-500 text-white px-3 py-1.5 font-semibold text-xs shadow-sm">Đúng: 0</span>
              <div id="scoreText" class="font-bold text-slate-700 text-base">Điểm: 0</div>
            </div>
          </div>
          <div class="h-3 w-full overflow-hidden rounded-full bg-slate-100 shadow-inner">
            <div id="progressBar" class="progress-bar h-full w-0 rounded-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 shadow-sm"></div>
          </div>
        </section>

        <div id="card" class="fade-in rounded-2xl bg-white p-6 sm:p-8 shadow-xl border border-slate-100">
          <div class="flex items-start justify-between mb-4">
            <div id="questionText" class="flex-1 text-xl sm:text-2xl font-bold text-slate-800 leading-relaxed">Đang tải…</div>
            <button id="btnBookmark" class="bookmark-btn ml-4 p-2 rounded-lg hover:bg-slate-100 transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"/></svg>
            </button>
          </div>
          <div id="choices" class="flex flex-col gap-3.5"></div>
          <div id="hintWrap" class="mt-6 hidden">
            <button id="btnHint" class="rounded-xl border-2 border-amber-500 bg-gradient-to-r from-amber-600 to-yellow-600 px-4 py-2.5 text-sm font-semibold text-white hover:from-amber-700 hover:to-yellow-700 transition-all duration-200 shadow-sm hover:shadow-md">💡 Xem gợi ý</button>
            <div id="hintText" class="mt-3 hidden rounded-xl bg-gradient-to-r from-slate-700 to-slate-800 border-l-4 border-amber-500 p-4 text-sm text-amber-200 shadow-sm"></div>
          </div>
          <div id="explainWrap" class="mt-5 hidden"><div id="explainText" class=""></div></div>
          <div class="mt-8">
            <div class="flex items-center gap-3 mb-3 flex-wrap">
              <button id="btnPrev" class="rounded-xl bg-white border-2 border-slate-300 px-5 py-2.5 font-semibold text-slate-700 hover:bg-slate-50 hover:border-slate-400 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-200 shadow-sm">Trước</button>
              <button id="btnNext" class="rounded-xl bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-2.5 text-white font-semibold hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg hover:scale-105">Tiếp tục</button>
              <button id="btnReveal" class="hidden rounded-xl border-2 border-blue-300 bg-blue-50 px-5 py-2.5 font-semibold text-blue-700 hover:bg-blue-100 hover:border-blue-400 transition-all duration-200 shadow-sm">Xem đáp án</button>
            </div>
          </div>
        </div>

        <section id="summary" class="mt-8 hidden rounded-2xl bg-gradient-to-br from-white to-blue-50 p-6 sm:p-8 shadow-xl border-2 border-blue-100">
          <h2 class="mb-4 text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Kết quả bài làm</h2>
          <p id="summaryText" class="text-base text-slate-700 leading-relaxed mb-6 p-4 bg-white rounded-xl border border-slate-200 shadow-sm"></p>
          <div id="statsChart" class="mb-6 p-6 bg-white rounded-xl border border-slate-200 shadow-sm">
            <h3 class="text-lg font-bold text-slate-800 mb-4">Thống kê chi tiết</h3>
            <div class="flex flex-col md:flex-row items-center justify-around gap-6">
              <div class="relative">
                <svg id="pieChart" width="200" height="200" viewBox="0 0 200 200"></svg>
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                  <div class="text-center">
                    <div id="chartPercentage" class="text-3xl font-bold text-slate-800">0%</div>
                    <div class="text-xs text-slate-500">Độ chính xác</div>
                  </div>
                </div>
              </div>
              <div class="flex flex-col gap-3">
                <div class="flex items-center gap-3"><div class="w-4 h-4 rounded bg-emerald-500"></div><span class="text-sm text-slate-700">Đúng: <span id="statCorrect" class="font-bold">0</span></span></div>
                <div class="flex items-center gap-3"><div class="w-4 h-4 rounded bg-rose-500"></div><span class="text-sm text-slate-700">Sai: <span id="statWrong" class="font-bold">0</span></span></div>
                <div class="flex items-center gap-3"><div class="w-4 h-4 rounded bg-slate-300"></div><span class="text-sm text-slate-700">Chưa làm: <span id="statUnanswered" class="font-bold">0</span></span></div>
                <div class="pt-3 border-t border-slate-200">
                  <div class="text-sm text-slate-700">Thời gian: <span id="statTime" class="font-bold">0:00</span></div>
                  <div class="text-xs text-slate-500 mt-1">TB: <span id="statAvgTime">0s</span>/câu</div>
                </div>
              </div>
            </div>
          </div>
          <div class="flex flex-wrap gap-3">
            <button id="btnReviewWrong" class="rounded-xl bg-gradient-to-r from-rose-500 to-red-500 px-6 py-3 text-white font-semibold hover:from-rose-600 hover:to-red-600 transition-all duration-200 shadow-md hover:shadow-lg hover:scale-105">Ôn lại câu sai</button>
            <button id="btnRestart2" class="rounded-xl bg-gradient-to-r from-slate-700 to-slate-900 px-6 py-3 text-white font-semibold hover:from-slate-800 hover:to-black transition-all duration-200 shadow-md hover:shadow-lg hover:scale-105">Làm lại toàn bộ</button>
          </div>
        </section>
      </main>
    </div>

    <footer class="mt-12 mb-6 text-center">
      <div class="inline-block px-6 py-3 bg-white rounded-xl border border-slate-200 shadow-sm">
        <p class="text-xs text-slate-500 leading-relaxed">Dữ liệu từ <code id="currentFile" class="px-2 py-0.5 bg-slate-100 text-slate-700 rounded font-mono text-xs">c.json</code><span class="mx-2 text-slate-300">•</span>Tiến độ được lưu tự động</p>
      </div>
    </footer>
  </div>

  <div id="historyModal" class="modal">
    <div class="modal-content w-full max-w-4xl">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-slate-800">Lịch sử làm bài</h2>
        <button id="closeHistoryModal" class="p-2 hover:bg-slate-100 rounded-lg">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg>
        </button>
      </div>
      <div id="historyContent" class="space-y-3 max-h-96 overflow-y-auto"></div>
    </div>
  </div>

  <div id="bookmarksModal" class="modal">
    <div class="modal-content w-full max-w-4xl">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-slate-800">Câu hỏi đã đánh dấu</h2>
        <button id="closeBookmarksModal" class="p-2 hover:bg-slate-100 rounded-lg">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg>
        </button>
      </div>
      <div id="bookmarksContent" class="space-y-3 max-h-96 overflow-y-auto"></div>
    </div>
  </div>

  <div id="leaderboardModal" class="modal">
    <div class="modal-content w-full max-w-5xl" style="max-height: 90vh; overflow-y: auto;">
      <div class="flex items-center justify-between mb-6 sticky top-0 bg-white z-10 pb-4 border-b-2 border-slate-200">
        <div class="items-center gap-3">
          <h2 class="text-3xl font-bold text-slate-800">Bảng xếp hạng</h2>
        </div>
        <button id="closeLeaderboardModal" class="p-2 hover:bg-slate-100 rounded-lg transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <div class="flex gap-2 mb-6 overflow-x-auto">
        <button class="leaderboard-tab active" data-tab="week">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
          </svg>
          Tuần này
        </button>
        <button class="leaderboard-tab" data-tab="subject">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
          </svg>
          Theo môn
        </button>
      </div>

      <div id="leaderboardPodium" class="mb-8">
        <div class="flex items-end justify-center gap-4 mb-8">
          <div class="flex flex-col items-center flex-1 max-w-[180px]" style="animation: slideUp 0.6s ease-out 0.2s both;">
            <div class="w-16 h-16 rounded-full bg-gradient-to-br from-slate-300 to-slate-400 flex items-center justify-center mb-3 shadow-lg border-4 border-white">
              <span class="text-2xl">🥈</span>
            </div>
            <div class="text-center mb-3">
              <div class="font-bold text-slate-800 truncate" id="rank2Name">---</div>
              <div class="text-xs text-slate-500" id="rank2Score">0 điểm</div>
            </div>
            <div class="w-full bg-gradient-to-t from-slate-300 to-slate-200 rounded-t-xl p-4 text-center shadow-lg" style="height: 120px;">
              <div class="text-3xl font-bold text-slate-700">2</div>
              <div class="text-xs text-slate-600 mt-2"><span id="rank2Correct">0</span> đúng / <span id="rank2Wrong">0</span> sai</div>
            </div>
          </div>

          <div class="flex flex-col items-center flex-1 max-w-[200px]" style="animation: slideUp 0.6s ease-out both;">
            <div class="w-20 h-20 rounded-full bg-gradient-to-br from-yellow-300 via-yellow-400 to-yellow-500 flex items-center justify-center mb-3 shadow-xl border-4 border-white relative">
              <span class="text-3xl">👑</span>
              <div class="absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 text-white">
                  <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z" clip-rule="evenodd" />
                </svg>
              </div>
            </div>
            <div class="text-center mb-3">
              <div class="font-bold text-slate-800 text-lg truncate" id="rank1Name">---</div>
              <div class="text-sm font-semibold text-yellow-600" id="rank1Score">0 điểm</div>
            </div>
            <div class="w-full bg-gradient-to-t from-yellow-400 via-yellow-300 to-yellow-200 rounded-t-xl p-4 text-center shadow-xl" style="height: 160px;">
              <div class="text-4xl font-bold text-yellow-700">1</div>
              <div class="text-sm text-yellow-700 font-semibold mt-2"><span id="rank1Correct">0</span> đúng / <span id="rank1Wrong">0</span> sai</div>
              <div class="text-xs text-yellow-600 mt-1"><span id="rank1Accuracy">0%</span> chính xác</div>
            </div>
          </div>

          <!-- 3rd Place -->
          <div class="flex flex-col items-center flex-1 max-w-[180px]" style="animation: slideUp 0.6s ease-out 0.4s both;">
            <div class="w-16 h-16 rounded-full bg-gradient-to-br from-orange-300 to-orange-400 flex items-center justify-center mb-3 shadow-lg border-4 border-white">
              <span class="text-2xl">🥉</span>
            </div>
            <div class="text-center mb-3">
              <div class="font-bold text-slate-800 truncate" id="rank3Name">---</div>
              <div class="text-xs text-slate-500" id="rank3Score">0 điểm</div>
            </div>
            <div class="w-full bg-gradient-to-t from-orange-300 to-orange-200 rounded-t-xl p-4 text-center shadow-lg" style="height: 100px;">
              <div class="text-3xl font-bold text-orange-700">3</div>
              <div class="text-xs text-orange-600 mt-2"><span id="rank3Correct">0</span> đúng / <span id="rank3Wrong">0</span> sai</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Rest of Leaderboard -->
      <div id="leaderboardList" class="space-y-2">
        <!-- Will be populated by JavaScript -->
      </div>

      <div id="leaderboardLoading" class="text-center py-12 hidden">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-slate-200 border-t-yellow-500"></div>
        <p class="mt-4 text-slate-600">Đang tải bảng xếp hạng...</p>
      </div>

      <!-- Empty State -->
      <div id="leaderboardEmpty" class="text-center py-12 hidden">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16 mx-auto text-slate-300 mb-4">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.182 16.318A4.486 4.486 0 0 0 12.016 15a4.486 4.486 0 0 0-3.198 1.318M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z" />
        </svg>
        <p class="text-slate-500 text-lg font-medium">Chưa có dữ liệu</p>
        <p class="text-slate-400 text-sm mt-2">Hãy hoàn thành một bài quiz để lên bảng xếp hạng!</p>
      </div>
    </div>
  </div>

  <div id="chatContainer" class="chat-container" style="display: none;">
    <div class="chat-header" id="chatHeader">
      <div class="chat-header-title">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"/>
        </svg>
        <span>Chat</span>
        <span id="chatOnlineCount" class="text-xs px-2 py-0.5 bg-white/20 rounded-full">0</span>
      </div>
      <div class="chat-header-actions">
        <button id="chatMinimizeBtn" class="chat-header-btn" title="Thu gọn">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12h-15" />
          </svg>
        </button>
        <button id="chatCloseBtn" class="chat-header-btn" title="Đóng">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
    <div id="chatMessages" class="chat-messages"></div>
    <div class="chat-input-container">
      <input type="text" id="chatInput" class="chat-input" placeholder="Nhập tin nhắn..." maxlength="200">
      <button id="chatSendBtn" class="chat-send-btn">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
        </svg>
      </button>
    </div>
  </div>

  <button id="chatToggleBtn" class="fixed bottom-20 right-20 w-14 h-14 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg hover:shadow-xl transition-all hover:scale-110 flex items-center justify-center z-999">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z" />
    </svg>
    <span id="chatBadge" class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold" style="display: none;">0</span>
  </button>
  <script src="script.js"></script>
</body>
</html>
